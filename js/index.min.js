function printOrder(){const e=document.getElementById("order-details").outerHTML,t=document.getElementById("logoprint").outerHTML,n=window.open("","Print","width=600,height=600");n.document.write("<html><head><title>Order Details</title>"),n.document.write("</head><body >"),n.document.write(t),n.document.write("<h4>Clautech Items Order</h4>"),n.document.write("<p>Online purchase printout</p>"),n.document.write(e),n.document.write("</body></html>"),n.document.close(),n.focus(),n.print(),event.preventDefault()}document.addEventListener("DOMContentLoaded",function(){function e(e){const t=2;if(2===t||3===t)return e.preventDefault(),e.returnValue="",""}function t(){window.removeEventListener("beforeunload",e)}function n(){let e=document.querySelectorAll("#cart-table-body tr"),t=document.getElementById("checkout"),n=document.getElementById("ks");e.length>0&&3!==F?t.style.display="block":t.style.display="none",0==e.length||1==F?n.style.display="block":n.style.display="none"}function l(){o(),T.timer=setInterval(function(){T.timeLeft--;let e=Math.floor(T.timeLeft/60),t=T.timeLeft%60;t<10&&(t="0"+t),document.getElementById("countdown").textContent=`${e}m ${t}s`,T.timeLeft<=0&&(o(),alert("Time's up! Order has been cancelled."),y(),L.classList.add("close"),location.reload())},1e3)}function o(){T.timer&&(clearInterval(T.timer),T.timer=null)}function d(e){if(x.includes(e.target.parentElement.id))return duplicateId="#"+e.target.parentElement.id,C.querySelector(duplicateId).querySelector(".quantity-value").value++,a(e.target),i(),r(),void s();C.addEventListener("click",function(e){e.target&&e.target.classList.contains("remove")&&(c(e),s(),i(),r()),s(),i(),r()});let t=e.target.parentNode,l=t.id;x.unshift(l);let o=t.querySelector(".product-name").innerHTML,d=t.querySelector(".product-image").getAttribute("src"),m=t.querySelector(".product-price").innerHTML.replace(/[^\d.-]/g,"");m=Number(m);let y=m;thisClass=t.classList.value.split(" "),A[l]=thisClass,w.items.push({product:l,productName:o,productPrice:m,productUpdatedPrice:y});let p=document.createElement("tr"),g=`img-${l}`;p.setAttribute("id",g),document.getElementById("cart-table-img-body").appendChild(p);let E=p.insertCell(0),f=document.createElement("img");f.src=d,f.classList.add("thumbnail"),E.appendChild(f);let b=document.createElement("tr");b.setAttribute("id",l),b.setAttribute("data-img-row-id",`img-${l}`),C.appendChild(b);let I=b.insertCell(0);I.innerHTML=o;let B=b.insertCell(1);B.innerHTML=S,B.setAttribute("id","quantity");let k=b.insertCell(2);k.innerHTML=m,k.setAttribute("id","product-price"),k.setAttribute("class","cart-product-price");let h=b.insertCell(3);h.innerHTML=m,h.setAttribute("id","updated-product-price"),h.setAttribute("class","cart-updated-product-price");let v=b.insertCell(4);v.innerHTML="<button type='button' id='update' onclick='updateTotal()'><i class='fa fa-refresh' aria-hidden='true'></i></button>";let L=b.insertCell(5);L.innerHTML=q,i(),r(),n(),s(),$(".slider").toggleClass("close"),document.getElementById("cart-table-img-body").style.display="table-row-group",document.getElementById("subtotal").style.display="block",document.getElementById("total").style.display="block",u(),a(e.target),i(),r(),s(),updateTotalQuantity()}function c(e){let t=e.target.closest("tr");if(!t)return;let n=t.id;t.remove();let l=`img-${n}`;console.log("Image Row ID:",l);let o=document.getElementById(l);console.log("Image Row:",o),o?(o.remove(),i(),r(),u()):(console.log("Image row not found!"),i(),r(),u());let d=x.indexOf(n);-1!==d&&x.splice(d,1),w.items=w.items.filter(e=>e.product!==n),u(),C.addEventListener("input",function(e){e.target&&e.target.classList.contains("quantity-value")&&(a(e.target),s(),i(),r()),i(),r(),s()}),0==w.items.length?(document.getElementById("checkout").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total").style.display="none",document.getElementById("cart-table-img-body").style.display="none"):(document.getElementById("checkout").style.display="block",document.getElementById("subtotal-wrapper").style.display="block",document.getElementById("total-wrapper").style.display="block",document.getElementById("cart-table-img-body").style.display="block"),0===w.items.length&&(L.classList.add("close"),location.reload()),u()}function a(e){let t,l,o,d=e.parentNode.parentNode,a=d.id;for(let e of d.childNodes){switch(e.id){case"product-price":t=e,l=Number(e.innerHTML);break;case"updated-product-price":o=e}i(),r(),n(),s()}let u=Number(e.value);if(u<=0)c(e);else{let e=u*l;o.innerHTML=e.toFixed(2);for(let t of w.items)t.product===a&&(t.productUpdatedPrice=e);i(),r(),n()}}function i(){w.subtotal=0;for(let e of w.items)w.subtotal+=e.productUpdatedPrice;M.innerHTML=w.subtotal.toFixed(2)}function r(){w.total=0,w.total+=w.subtotal,P.innerHTML=w.total.toFixed(2);const e=document.getElementById("ks");e&&e.addEventListener("click",function(){F=1,b()})}function s(){let e=w.items.map(e=>{const t=document.querySelector(`#${e.product} .quantity-value`).value;return`${e.productName} (Qty: ${t} Price: ₦${e.productPrice.toFixed(2)})`});const t=e.join("|"),n=t+" ||Total: ₦"+w.total.toFixed(2),l=document.getElementById("productDetailsInput"),o=document.getElementById("InputPrice"),d=document.getElementById("inpTotal");l.value=n,o.value=w.total.toFixed(2),d.value=w.total.toFixed(2),i(),r(),m()}function u(){const e=document.getElementById("addNo"),t=document.getElementById("cart-text");e&&(e.textContent=w.items.length),w.items.length,t.style.display="none"}function m(){var e=document.getElementById("email").value,t=document.getElementById("orderNumber").value;document.getElementById("InputEmail").value=e,document.getElementById("orderNumberRef").value=t}function y(){let e=document.querySelectorAll("#cart-table-body tr");e.forEach(e=>{e.remove()}),w={items:[],subtotal:0,total:0},i(),r(),n(),0==w.items.length&&(L.classList.add("close"),location.reload())}function p(){document.querySelector(".cart").style.display="none",document.getElementById("checkout").style.display="none",document.querySelector(".form2flex").style.display="none",document.getElementById("next").style.display="none",document.getElementById("payment-options").style.display="none",document.getElementById("notifyButton").style.display="none",document.getElementById("goBackButton").style.display="none",document.getElementById("cancelOrderButton").style.display="none",document.getElementById("final-step").style.display="none"}function g(){let e=Math.floor(1e4+9e4*Math.random());return"CLTZ0"+e}function E(){const e=new Date,t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0"),o=e.getHours().toString().padStart(2,"0"),d=e.getMinutes().toString().padStart(2,"0"),c=e.getSeconds().toString().padStart(2,"0");return`${t}-${n}-${l} ${o}:${d}:${c}`}function f(){const e=document.getElementById("order-details");let t="<h4>Products Ordered:</h4><ul>";w.items.forEach(e=>{t+=`<li>${e.productName} - (Qty: ${document.querySelector(`#${e.product} .quantity-value`).value}  Price: ₦ ${e.productPrice.toFixed(2)})</li>`}),t+="</ul>";const n=document.getElementById("orderNumber").value,l=document.getElementById("name").value,o=document.getElementById("phone").value,d=document.getElementById("location").value,c=document.getElementById("cabin-no").value,a=document.getElementById("other-locations").value,i=document.getElementById("email").value,r=document.querySelector('input[name="bank"]:checked'),s=document.querySelector('input[name="payment-method"]:checked'),u="Items shall be released on confirmation of your payment. Thanks!";let m="";r&&(m+=`<p>Bank Transfer: ${r.value}</p>`),s&&(m+=`<p>Credit Card: ${s.value}</p>`),e.innerHTML=`\n\n            ${t}\n            <h4>Order Information:</h4>\n            <p>Order Number: <strong style="color: #ff6600;">${n}</strong></p>\n            <p>Name: ${l}</p>\n            <p>Phone: ${o}</p>\n            <p>Location: ${d}</p>\n            <p>Cabin No.: ${c}</p>\n            <p>Other Locations: ${a}</p>\n            <p>Email: ${i}</p>\n            <h5><strong>Payment Method:</strong></h5>\n            ${m}\n            <p>Date and Time: ${E()}</p>\n            <p style="color: #ff6600; font-style: italic; font-weight: 600;"><strong style="color: #000000; font-style: normal;">Note:</strong> ${u}</p>\n            <p>Subtotal: ₦${w.subtotal.toFixed(2)}</p>\n            <p><strong>Total: ₦${w.total.toFixed(2)}</strong></p>\n        `}function b(){switch(p(),1==F||0==w.items.length?document.getElementById("ks").style.display="block":document.getElementById("ks").style.display="none",F){case 1:document.querySelector(".cart").style.display="block",document.getElementById("checkout").style.display="block",document.getElementById("finalizeOrder").style.display="none",document.getElementById("next").style.display="none";break;case 2:document.querySelector(".form2flex").style.display="block",document.getElementById("next").style.display="block",document.getElementById("subtotal-label").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total-label").style.display="none",document.getElementById("total").style.display="none";break;case 3:document.querySelector(".cart").style.display="block",document.getElementById("payment-options").style.display="flex",document.getElementById("notifyButton").style.display="block",document.getElementById("goBackButton").style.display="block",document.getElementById("cancelOrderButton").style.display="block",document.getElementById("subtotal-label").style.display="block",document.getElementById("subtotal").style.display="block",document.getElementById("total-label").style.display="block",document.getElementById("total").style.display="block";break;case 4:document.getElementById("final-step").style.display="flex",f(),document.getElementById("finalizeOrder").style.display="block",document.getElementById("subtotal-label").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total-label").style.display="none",document.getElementById("total").style.display="none",document.getElementById("amount-controls").style.display="none"}if(1==F||0==w.items.length?document.getElementById("ks").style.display="block":document.getElementById("ks").style.display="none",0==w.items.length&&(document.getElementById("checkout").style.display="none",document.getElementById("next").style.display="none",document.getElementById("notifyButton").style.display="none",document.getElementById("finalizeOrder").style.display="none"),2==F){const t=document.getElementById("orderNumber");if(t){const e=g();t.value=e}window.addEventListener("beforeunload",e)}}function I(){const e=grecaptcha.getResponse();return""===e?(document.getElementById("error-captcha").innerText="Please complete the reCAPTCHA.",!1):(document.getElementById("error-captcha").innerText="",!0)}function B(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)}function k(){const e={email:document.getElementById("InputEmail").value,amount:document.getElementById("InputPrice").value,orderNumberRef:document.getElementById("orderNumberRef").value};h(e)}function h(e){const t=I();if(!t){const e=document.getElementById("errcaptcha");return e.textContent="Please complete the reCAPTCHA.",e.style.display="block",void alert("Please complete the reCAPTCHA.")}let n=PaystackPop.setup({key:"pk_live_d4fff1f36dac3a20aaa74cbd5a7ebd0338c1b58f",email:e.email,amount:100*e.amount,currency:"NGN",ref:e.orderNumberRef,channel:"card",onClose:function(){alert("Click Okay to Cancel.")},callback:function(e){let t="Payment Successful! Order No: "+e.reference;for(;;){let e=confirm(t+"\n\n Click Okay to proceed ");if(e){document.getElementById("cartForm").submit(),F=4,b();break}}}});n.openIframe()}const v=document.getElementById("cart-button"),L=document.getElementById("cart-wrapper"),S=(document.querySelectorAll(".add-to-cart"),"<input name='quantity' id='quantity' class='quantity-value' type='number' value='1' min='1' onchange='quantitySet()'>"),q="<button type='button' class='remove' onclick='removeFromCart(event)'>X</button>",C=document.getElementById("cart-table-body"),M=document.getElementById("subtotal"),P=document.getElementById("total");let T={timer:null,timeLeft:900},x=[],A={},w={items:[],subtotal:0,finalDis:0,total:0};const N=document.getElementById("ks");N&&N.addEventListener("click",function(){L.classList.add("close")});const O=document.querySelectorAll(".bank-radio");O.forEach(function(e){e.addEventListener("change",function(){l()})});const H=document.querySelector(".payment-method");H.addEventListener("change",function(){o()}),C.addEventListener("input",function(e){e.target&&e.target.classList.contains("quantity-value")&&(a(e.target),quantitySet(),i(),r(),s()),s(),i(),r()}),v.addEventListener("click",function(){L.classList.toggle("close")});const D=document.getElementById("next");D&&D.addEventListener("click",function(){F++,b()});let F=1;document.getElementById("checkout").addEventListener("click",function(){F=2,b(),i(),r(),s(),w.items.forEach(e=>{const t=document.querySelector(`#${e.product} .quantity-value`),n=parseInt(t.value,10);e.quantity=n,e.productUpdatedPrice=e.productPrice*n;const l=document.querySelector(`#${e.productPrice} .updated-product-price`);l.textContent=e.productUpdatedPrice}),i(),r()}),document.getElementById("next").addEventListener("click",function(e){e.preventDefault();document.getElementById("phone");const t=document.getElementById("email"),n=B(t.value),l=document.getElementById("invalidMsg");if(n){l.style.display="none",t.classList.remove("invalid-input");const e=I(),n=document.getElementById("recaptMsgMsg");let o=document.getElementById("payment-options");if(!e)return n.style.display="block",n.style.opacity=1,o.style.background="#d66e0057",o.style.opacity=.4,void alert("Please complete the reCAPTCHA.");F=3,b(),m(),i(),r(),s()}else t.classList.add("invalid-input"),l.textContent="Invalid email",l.style.display="block",F=2,b();const o=document.getElementById("recaptMsgMsg");let d=document.getElementById("payment-options");o.style.display="none",o.style.opacity=1,d.style.background="transparent",d.style.opacity=1}),document.getElementById("notifyButton").addEventListener("click",function(e){o(),t();const n=document.querySelector(".bank-radio:checked"),l=document.querySelector('input[name="payment-method"]:checked'),d=document.getElementById("initPayMsg");let c=document.getElementById("payment-options");if(n||l){const t=I(),n=document.getElementById("recaptMsgMsg");let l=document.getElementById("payment-options");t?(F=4,b(),document.getElementById("cartForm").submit(),n.style.display="none",n.style.opacity=1,l.style.background="transparent",l.style.opacity=1):(e.preventDefault(),n.style.display="block",n.style.opacity=1,l.style.background="#d66e0057",l.style.opacity=.4)}else e.preventDefault(),d.style.display="block",d.style.opacity=1,c.style.background="#d66e0057",c.style.opacity=.4}),document.getElementById("goBackButton").addEventListener("click",function(){F=2,b();const e=document.getElementById("recaptMsgMsg");let t=document.getElementById("payment-options");e.style.display="none",e.style.opacity=1,t.style.background="transparent",t.style.opacity=1}),document.addEventListener("click",function(e){e.target&&e.target.classList.contains("add-to-cart")&&d(e)}),document.getElementById("cancelOrderButton").addEventListener("click",function(){y(),L.classList.add("close"),location.reload()}),document.getElementById("finalizeOrder").addEventListener("click",function(){location.reload()});const R=document.getElementById("paystackButton");R.addEventListener("click",function(e){e.preventDefault(),k()},!1),n()});const bankRadios=document.querySelectorAll(".bank-radio"),tmrElements=document.querySelectorAll(".tmr"),noteMsgElements=document.querySelectorAll(".note-msg");tmrElements.forEach(function(e){e.style.display="none"}),noteMsgElements.forEach(function(e){e.style.display="none"}),bankRadios.forEach(function(e){e.addEventListener("change",function(){const t=document.querySelectorAll(".bank-details");t.forEach(function(e){e.style.display="none"});const n=e.value,l=document.querySelector(".bank-details."+n),o=document.getElementById("initPayMsg");let d=document.getElementById("payment-options");if(l){l.style.display="block";const e=l.parentElement.querySelectorAll(".tmr, .note-msg");e.forEach(function(e){e.style.display="block"}),o.style.display="none",d.style.background="transparent",d.style.opacity=1}})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".payment-method");e.forEach(function(e){e.addEventListener("change",function(){if("credit-card"===e.value){const e=document.querySelectorAll(".bank-details");e.forEach(function(e){e.style.display="none"}),document.querySelector(".credit-card-details").style.display="flex"}else document.querySelector(".credit-card-details").style.display="none"})});const t=document.querySelector(".payment-method"),n=document.getElementById("selectedPaymentMethod"),l=document.getElementById("initPayMsg");let o=document.getElementById("payment-options");t.addEventListener("change",function(){n.value=t.value;const e=document.querySelectorAll(".bank-radio");e.forEach(e=>{e.checked=!1,l.style.display="none",o.style.background="transparent",o.style.opacity=1}),stopTimer()});const d=document.querySelectorAll(".bank-radio");d.forEach(e=>{e.addEventListener("change",function(){n.value=e.value,t.checked=!1,document.querySelector(".credit-card-details").style.display="none"})})});