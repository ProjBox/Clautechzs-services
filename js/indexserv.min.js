function printOrder(){const e=document.getElementById("order-details").outerHTML,t=document.getElementById("logoprint").outerHTML,n=window.open("","Print","width=600,height=600");n.document.write("<html><head><title>Order Details</title>"),n.document.write("</head><body >"),n.document.write(t),n.document.write("<h4>Clautech Items Order</h4>"),n.document.write("<p>Online purchase printout</p>"),n.document.write(e),n.document.write("</body></html>"),n.document.close(),n.focus(),n.print(),event.preventDefault()}document.addEventListener("DOMContentLoaded",function(){function e(){let e=document.querySelectorAll("#cart-table-body tr"),t=document.getElementById("checkout"),n=document.getElementById("ks");e.length>0&&3!==A?t.style.display="block":t.style.display="none",0==e.length||1==A?n.style.display="block":n.style.display="none"}function t(){n(),M.timer=setInterval(function(){M.timeLeft--;let e=Math.floor(M.timeLeft/60),t=M.timeLeft%60;t<10&&(t="0"+t),document.getElementById("countdown").textContent=`${e}m ${t}s`,M.timeLeft<=0&&(n(),alert("Time's up! Order has been cancelled."),r(),k.classList.add("close"),location.reload())},1e3)}function n(){M.timer&&(clearInterval(M.timer),M.timer=null)}function l(t){if(C.includes(t.target.parentElement.id))return duplicateId="#"+t.target.parentElement.id,L.querySelector(duplicateId).querySelector(".quantity-value").value++,d(t.target),c(),a(),void i();L.addEventListener("click",function(e){e.target&&e.target.classList.contains("remove")&&(o(e),i(),c(),a()),i(),c(),a()});let n=t.target.parentNode,l=n.id;C.unshift(l);let u=n.querySelector(".product-name").innerHTML,r=n.querySelector(".product-image").getAttribute("src"),s=n.querySelector(".product-price").innerHTML.replace(/[^\d.-]/g,"");s=Number(s);let m=s;thisClass=n.classList.value.split(" "),T[l]=thisClass,x.items.push({product:l,productName:u,productPrice:s,productUpdatedPrice:m});let y=document.createElement("tr");document.getElementById("cart-table-img-body").appendChild(y);let p=y.insertCell(0),g=document.createElement("img");g.src=r,g.classList.add("thumbnail"),p.appendChild(g);let E=document.createElement("tr");E.setAttribute("id",l),L.appendChild(E);let f=E.insertCell(0);f.innerHTML=u;let b=E.insertCell(1);b.innerHTML=h,b.setAttribute("id","quantity");let B=E.insertCell(2);B.innerHTML=s,B.setAttribute("id","product-price"),B.setAttribute("class","cart-product-price");let I=E.insertCell(3);I.innerHTML=s,I.setAttribute("id","updated-product-price"),I.setAttribute("class","cart-updated-product-price");let k=E.insertCell(4);k.innerHTML="<button type='button' id='update' onclick='updateTotal()'><i class='fa fa-refresh' aria-hidden='true'></i></button>";let S=E.insertCell(5);S.innerHTML=v,c(),a(),e(),i(),$(".slider").toggleClass("close"),document.getElementById("cart-table-img-body").style.display="table-row-group",document.getElementById("subtotal").style.display="block",document.getElementById("total").style.display="block",d(t.target),c(),a(),i()}function o(e){e.preventDefault();let t=e.target.closest("tr");if(!t)return;let n=t.parentNode,l=t.id;n.removeChild(t);var o=C.indexOf(l);-1!==o&&C.splice(o,1);for(let e of x.items)if(e.product===l){let t=x.items.indexOf(e);x.items.splice(t,1)}L.addEventListener("input",function(e){e.target&&e.target.classList.contains("quantity-value")&&(d(e.target),i(),c(),a()),c(),a(),i()});let u=document.getElementById("cart-table-img-body"),r=u.querySelector("tr");r&&(u.removeChild(r),c(),a()),0==x.items.length?(document.getElementById("checkout").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total").style.display="none",document.getElementById("cart-table-img-body").style.display="none"):(document.getElementById("checkout").style.display="block",document.getElementById("subtotal-wrapper").style.display="block",document.getElementById("total-wrapper").style.display="block",document.getElementById("cart-table-img-body").style.display="block"),0===x.items.length&&(k.classList.add("close"),location.reload())}function d(t){let n,l,d,u=t.parentNode.parentNode,r=u.id;for(let t of u.childNodes){switch(t.id){case"product-price":n=t,l=Number(t.innerHTML);break;case"updated-product-price":d=t}c(),a(),e(),i()}let s=Number(t.value);if(s<=0)o(t);else{let t=s*l;d.innerHTML=t.toFixed(2);for(let e of x.items)e.product===r&&(e.productUpdatedPrice=t);c(),a(),e()}}function c(){x.subtotal=0;for(let e of x.items)x.subtotal+=e.productUpdatedPrice;S.innerHTML=x.subtotal.toFixed(2)}function a(){x.total=0,x.total+=x.subtotal,q.innerHTML=x.total.toFixed(2);const e=document.getElementById("ks");e&&e.addEventListener("click",function(){A=1,g()})}function i(){let e=x.items.map(e=>{const t=document.querySelector(`#${e.product} .quantity-value`).value;return`${e.productName} (Qty: ${t} Price: ₦${e.productPrice.toFixed(2)})`});const t=e.join(" | "),n=t+" || Total: ₦"+x.total.toFixed(2),l=document.getElementById("productDetailsInput"),o=document.getElementById("InputPrice"),d=document.getElementById("inpTotal");l.value=n,o.value=x.total.toFixed(2),d.value=x.total.toFixed(2),c(),a(),u()}function u(){var e=document.getElementById("email").value,t=document.getElementById("orderNumber").value;document.getElementById("InputEmail").value=e,document.getElementById("orderNumberRef").value=t}function r(){let t=document.querySelectorAll("#cart-table-body tr");t.forEach(e=>{e.remove()}),x={items:[],subtotal:0,total:0},c(),a(),e(),0==x.items.length&&(k.classList.add("close"),location.reload())}function s(){document.querySelector(".cart").style.display="none",document.getElementById("checkout").style.display="none",document.querySelector(".form2flex").style.display="none",document.getElementById("next").style.display="none",document.getElementById("payment-options").style.display="none",document.getElementById("notifyButton").style.display="none",document.getElementById("goBackButton").style.display="none",document.getElementById("cancelOrderButton").style.display="none",document.getElementById("final-step").style.display="none"}function m(){let e=Math.floor(1e4+9e4*Math.random());return"CLTZ0"+e}function y(){const e=new Date,t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0"),o=e.getHours().toString().padStart(2,"0"),d=e.getMinutes().toString().padStart(2,"0"),c=e.getSeconds().toString().padStart(2,"0");return`${t}-${n}-${l} ${o}:${d}:${c}`}function p(){const e=document.getElementById("order-details");let t="<h4>Products Ordered:</h4><ul>";x.items.forEach(e=>{t+=`<li>${e.productName} - (Qty: ${document.querySelector(`#${e.product} .quantity-value`).value}  Price: ₦ ${e.productPrice.toFixed(2)})</li>`}),t+="</ul>";const n=document.getElementById("orderNumber").value,l=document.getElementById("name").value,o=document.getElementById("phone").value,d=document.getElementById("location").value,c=document.getElementById("cabin-no").value,a=document.getElementById("other-locations").value,i=document.getElementById("email").value,u=document.querySelector('input[name="bank"]:checked'),r=document.querySelector('input[name="payment-method"]:checked'),s="Items shall be released on confirmation of your payment. Thanks!";let m="";u&&(m+=`<p>Bank Transfer: ${u.value}</p>`),r&&(m+=`<p>Credit Card: ${r.value}</p>`),e.innerHTML=`\n\n            ${t}\n            <h4>Order Information:</h4>\n            <p>Order Number: ${n}</p>\n            <p>Name: ${l}</p>\n            <p>Phone: ${o}</p>\n            <p>Location: ${d}</p>\n            <p>Cabin No.: ${c}</p>\n            <p>Other Locations: ${a}</p>\n            <p>Email: ${i}</p>\n            <h5><strong>Payment Method:</strong></h5>\n            ${m}\n            <p>Date and Time: ${y()}</p>\n            <p><strong>Note:</strong> ${s}</p>\n            <p>Subtotal: ₦${x.subtotal.toFixed(2)}</p>\n            <p><strong>Total: ₦${x.total.toFixed(2)}</strong></p>\n        `}function g(){switch(s(),1==A||0==x.items.length?document.getElementById("ks").style.display="block":document.getElementById("ks").style.display="none",A){case 1:document.querySelector(".cart").style.display="block",document.getElementById("checkout").style.display="block",document.getElementById("finalizeOrder").style.display="none",document.getElementById("next").style.display="none";break;case 2:document.querySelector(".form2flex").style.display="block",document.getElementById("next").style.display="block",document.getElementById("subtotal-label").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total-label").style.display="none",document.getElementById("total").style.display="none";break;case 3:document.querySelector(".cart").style.display="block",document.getElementById("payment-options").style.display="flex",document.getElementById("notifyButton").style.display="block",document.getElementById("goBackButton").style.display="block",document.getElementById("cancelOrderButton").style.display="block",document.getElementById("subtotal-label").style.display="block",document.getElementById("subtotal").style.display="block",document.getElementById("total-label").style.display="block",document.getElementById("total").style.display="block";break;case 4:document.getElementById("final-step").style.display="flex",p(),document.getElementById("finalizeOrder").style.display="block",document.getElementById("subtotal-label").style.display="none",document.getElementById("subtotal").style.display="none",document.getElementById("total-label").style.display="none",document.getElementById("total").style.display="none",document.getElementById("amount-controls").style.display="none"}if(1==A||0==x.items.length?document.getElementById("ks").style.display="block":document.getElementById("ks").style.display="none",0==x.items.length&&(document.getElementById("checkout").style.display="none",document.getElementById("next").style.display="none",document.getElementById("notifyButton").style.display="none",document.getElementById("finalizeOrder").style.display="none"),2==A){const e=document.getElementById("orderNumber");if(e){const t=m();e.value=t}}}function E(e){const t=/0\d{10,}/;return t.test(e)}function f(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)}function b(){const e={email:document.getElementById("InputEmail").value,amount:document.getElementById("InputPrice").value,orderNumberRef:document.getElementById("orderNumberRef").value};B(e)}function B(e){let t=PaystackPop.setup({key:"pk_test_6b1cc58f2827ac858c2d25c77ee1d78498cb8f9f",email:e.email,amount:100*e.amount,currency:"NGN",ref:e.orderNumberRef,channel:"card",onClose:function(){alert("Window closed.")},callback:function(e){let t="Payment complete! Reference: "+e.reference;for(;;){let e=confirm(t+"\n\n click to proceed ");if(e){document.getElementById("cartForm").submit(),A=4,g();break}}}});t.openIframe()}const I=document.getElementById("cart-button"),k=document.getElementById("cart-wrapper"),h=(document.querySelectorAll(".add-to-cart"),"<input name='quantity' id='quantity' class='quantity-value' type='number' value='1' min='1' onchange='quantitySet()'>"),v="<button type='button' class='remove' onclick='removeFromCart(event)'>X</button>",L=document.getElementById("cart-table-body"),S=document.getElementById("subtotal"),q=document.getElementById("total");let M={timer:null,timeLeft:900},C=[],T={},x={items:[],subtotal:0,finalDis:0,total:0};const P=document.getElementById("ks");P&&P.addEventListener("click",function(){k.classList.add("close")});const N=document.querySelectorAll(".bank-radio");N.forEach(function(e){e.addEventListener("change",function(){t()})});const O=document.querySelector(".payment-method");O.addEventListener("change",function(){n()}),L.addEventListener("input",function(e){e.target&&e.target.classList.contains("quantity-value")&&(d(e.target),quantitySet(),c(),a(),i()),i(),c(),a()}),I.addEventListener("click",function(){k.classList.toggle("close")});const w=document.getElementById("next");w&&w.addEventListener("click",function(){A++,g()});let A=1;document.getElementById("checkout").addEventListener("click",function(){A=2,g(),c(),a(),i(),x.items.forEach(e=>{const t=document.querySelector(`#${e.product} .quantity-value`),n=parseInt(t.value,10);e.quantity=n,e.productUpdatedPrice=e.productPrice*n;const l=document.querySelector(`#${e.productPrice} .updated-product-price`);l.textContent=e.productUpdatedPrice}),c(),a()}),document.getElementById("next").addEventListener("click",function(){const e=document.getElementById("phone"),t=document.getElementById("email"),n=(E(e.value),f(t.value),document.getElementById("invalidMsg"));E(e.value)||f(t.value)?(n.style.display="none",t.classList.remove("invalid-input"),A=3,g(),u(),c(),a(),i()):(t.classList.add("invalid-input"),n.style.display="block",A=2,g())}),document.getElementById("notifyButton").addEventListener("click",function(e){const t=document.querySelector(".bank-radio:checked"),n=document.querySelector('input[name="payment-method"]:checked'),l=document.getElementById("initPayMsg");let o=document.getElementById("payment-options");t||n?(A=4,g()):(e.preventDefault(),l.style.display="block",l.style.opacity=1,o.style.background="#d66e0057",o.style.opacity=.4)}),document.getElementById("goBackButton").addEventListener("click",function(){A=2,g()}),document.addEventListener("click",function(e){e.target&&e.target.classList.contains("add-to-cart")&&l(e)}),document.getElementById("cancelOrderButton").addEventListener("click",function(){r(),k.classList.add("close"),location.reload()}),document.getElementById("finalizeOrder").addEventListener("click",function(){location.reload()});const H=document.getElementById("paystackButton");H.addEventListener("click",function(e){e.preventDefault(),b()},!1),e()});const bankRadios=document.querySelectorAll(".bank-radio");bankRadios.forEach(function(e){e.addEventListener("change",function(){const t=document.querySelectorAll(".bank-details");t.forEach(function(e){e.style.display="none"});const n=e.value,l=document.querySelector(".bank-details."+n),o=document.getElementById("initPayMsg");let d=document.getElementById("payment-options");l&&(l.style.display="block"),o.style.display="none",d.style.background="transparent",d.style.opacity=1,startTimer()})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".payment-method");e.forEach(function(e){e.addEventListener("change",function(){if("credit-card"===e.value){const e=document.querySelectorAll(".bank-details");e.forEach(function(e){e.style.display="none"}),document.querySelector(".credit-card-details").style.display="flex"}else document.querySelector(".credit-card-details").style.display="none"})});const t=document.querySelector(".payment-method"),n=document.getElementById("selectedPaymentMethod"),l=document.getElementById("initPayMsg");let o=document.getElementById("payment-options");t.addEventListener("change",function(){n.value=t.value;const e=document.querySelectorAll(".bank-radio");e.forEach(e=>{e.checked=!1,l.style.display="none",o.style.background="transparent",o.style.opacity=1}),stopTimer()});const d=document.querySelectorAll(".bank-radio");d.forEach(e=>{e.addEventListener("change",function(){n.value=e.value,t.checked=!1,document.querySelector(".credit-card-details").style.display="none"})})});